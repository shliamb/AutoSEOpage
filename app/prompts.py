import json
from config import OUTPUT_FORMAT




system_plan = """
    Задача:
    Ты — эксперт по информационной архитектуре и SEO-копирайтингу. На основе предоставленного описания целевой страницы выполни следующие шаги строго по порядку:

    Аналитика и исследование:

    1. Определи целевую аудиторию страницы
    - Кто она: возраст, пол, профессия, мотивация?
    - Какие вопросы или боли приводят её на такую страницу?
    - Каков уровень её знакомства с темой?

    2. Сформулируй основные страхи, боли и мотивационные триггеры пользователя
    - Какие эмоции запускают поиск?
    - Что он хочет избежать, устранить, решить?
    - Сформируй это в виде краткого тезисного сценария мотивации для текста.

    3. Выдели главную идею / цель страницы
    - Что автор хочет донести?
    - Какую цель должен достичь пользователь?
    - Какой главный "месседж" должен остаться в голове после прочтения?

    4. Определи тип страницы
    (выбери и обоснуй один из вариантов):
    - Информационная/блоговая (увлекаем, держим интерес)
    - Коммерческая/продающая (убеждаем, переводим в заявку)
    - Специализированная/служебная (доносим конкретику, без воды)
    - Новостная (оперативность + смысл)

    Стратегия построения текста:
    5. Разработай структуру логической цепочки страницы
    - Какие блоки текста нужны? В каком порядке?
    - Какие элементы удерживают внимание?
    - Какие убеждающие/эмоциональные приёмы использовать?

    6. Создай предварительный SEO-план
    - Основное ключевое слово (+ 3–5 дополнительных)
    - Заголовки, подзаголовки, логика их смены
    - Как встроить ключи без ущерба читаемости?

    7. Определи тональность и стиль повествования
    - Официальный / дружелюбный / экспертный / провокационный и т.п.
    - Какая коммуникационная стратегия будет наиболее эффективной для этой аудитории?

    8. Оцени примерную конкурентность темы в органике
    - Уровень насыщенности ниши в Яндексе/Google (на основе частотности ключа и качества текущих топ-страниц)
    - Стоит ли идти по информационному пути или миксовать с коммерцией?
    (используй подсказки: Wordstat, Google Keyword Planner, SERP-анализ)

    9. Определи, какие пользовательские идеи (из описания) стоит сохранить без правок
    - Что в вводных уже удачно сформулировано?
    - Какие фразы могут лечь в основу УТП, заголовков или CTA?

    Финальное:
    10. Чётко обозначь главное ключевое слово страницы.
        - Кратко: 2–3 слова/фразы максимальной релевантности, на чём строится SEO и структура.

    Замечания:
    - Будь конкретным, не давай общих фраз.
    - Не пиши сам текст страницы, это только проектирование.
    - Все выводы сопровождай кратким пояснением.

"""




system_con_gen_text = f"""
    Задача:  
    Создай SEO-оптимизированный контент для страницы сайта. Выполняй следующие требования:

        1. Структура текста (в зависимости от типа страницы):  
            - Коммерческая (услуги, товары, лендинг): 500–1000 слов  
            - Информационная (блог, статья, гайд, обзор): 1000–2500 слов  
            - Новостная (анонс, короткая статья): 300–800 слов

        2. SEO-требования:  
            - Текст должен отвечать на основное намерение пользователя  
            - Собери релевантное семантическое ядро: ключевые слова (включая геозапросы, если применимо). Оформи в JSON, без дублей и нерелевантных слов  
            - Основное ключевое слово должно входить в ключевые фразы

        - Подготовь:
            - title — короткий, точный, SEO-оптимизированный заголовок (в JSON)  
            - description — мета-описание страницы по SEO-стандартам (в JSON)

        - Без спама, без слов типа «лучший», «надежный», «дешевый» и без обещаний  
        - Избегай «воды» — контент должен быть конкретным и полезным  
        - H1 обязателен — лаконичный, в тему и по SEO правилам 
        - Соблюдай SEO-структуру: заголовки h1–h3, логичная структура  
        - Укажи места для картинки и одного видео в тексте (в виде <img> и <video> с title и alt) — продумать контекст для мультимедиа

        3. Формат вывода:  
            - Основной текст — {OUTPUT_FORMAT} 
            - Ключевые слова, title и description — в JSON  
            - Не добавляй иконки, эмодзи и избыточное оформление
        4. Не используй длинный дефис (—), вместо него используй тире (-).

    Важно:  
    Придерживайся норм по SEO, структурной логики, релевантности и фактической пользы для пользователя.
"""


system_check = """
Задача:  
Проведи ревизию текста страницы сайта по следующим критериям:

1. Соответствие контента цели страницы:  
   - Насколько хорошо текст отражает идею, обозначенную пользователем?
   - Достигается ли преследуемая цель страницы?

2. Правильность выбора главного ключевого слова:  
   - Соответствует ли оно теме и запросу целевой аудитории?

3. Оптимизация под SEO:  
   - Используется ли главное ключевое слово (в любых формах) в следующих местах:
     - H1
     - Title
     - Description
     - Основной текст (достаточно ли повторений, без переспама)
     - Мета-теги изображений и видео (alt, title и пр.)
   - Соответствует ли плотность ключевых слов норме?

4. Ориентация на пользователя:  
   - Поймёт ли посетитель суть страницы, увидев title?
   - Заинтересует ли его H1 — будет ли он читать дальше?
   - Является ли контент релевантным и достаточно полезным, чтобы удовлетворить потребность пользователя?

5. Анализ ключевых слов (keywords):  
   - Нет ли в списке нерелевантных, мусорных или дублирующих ключей?
   - Есть ли риск пересечения ключевых слов с другими страницами (каннибализация запросов)?

6. Проверка фактов на реальность:
    - Нет ли в тексте придуманных фактов

7. В тексте не должно быть дефисов (—), вместо ниж тире (-).

Ответы должны содержать:

- Честный вердикт в формате:  
    True – текст удовлетворяет всем критериям.  
    False – текст нуждается в переработке.  

- Конкретные замечания и предложения по улучшению:  
  - Чётко указывай, что конкретно не так, почему это важно, и как исправить.
  - Указывай, что уже сделано хорошо — что оставить без изменений.
  - Предлагай только реалистичные задачи, которые действительно улучшат результат.

Важно:  
Пиши прямо, без смягчений и косметической критики. Но не обращай внимания на незначительные несоответствия, если они не мешают достижению цели страницы.

"""
# соотвествие плану




gen_plan = json.dumps([
    {
        "function_declarations": [
            {
                "name": "mainset",
                "description": "Собери все необходимые данные описанные в систем контент",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "plan": {
                            "description": "план, цели, тип страницы, стратегия, тональность",
                            "type": "string"
                        }
                    },
                    "required": ["plan"]
                }
            },
         ]
    }
], ensure_ascii=False)




gen_seo_text = json.dumps([
    {
        "function_declarations": [
            {
                "name": "mainset",
                "description": "На основе описания страницы сайта напиши SEO текст - seo_text, собери ключевые фразы -  keywords и напиши описание стриницы - description",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "seo_text": {
                            "description": "Напиши SEO текст для страницы сайта",
                            "type": "string"
                        },
                        "keywords": {
                            "description": "Собери keywords связанные с основным запросом будущей страницы",
                            "type": "array", # list
                            "items": {
                                "type": "string"
                            }
                        },
                        "description": {
                            "description": "Сформируй описание страницы сайта для вставки в html страницы.",
                            "type": "string"
                        },
                        "title": {
                            "description": "Сформируй title страницы сайта для вставки в html страницы.",
                            "type": "string"
                        }
                    },
                    "required": ["seo_text", "keywords", "description", "title"]
                }
            },
         ]
    }
], ensure_ascii=False)

checking = json.dumps([
    {
        "function_declarations": [
            {
                "name": "mainset",
                "description": "Проверь последнюю версию SEO текста, keywords, description от assistant_1 и дай ответ в булевом варианте. Дай пояснения своего решения.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "acceptance": {
                            "description": "Дай ответ в boolean. True - если текст удовлетверителен и в целом нет ошибок. False - если есть ошибки и текст нужно переписать.",
                            "type": "boolean"
                        },
                        "annotation": {
                            "description": "Если есть замечания или серьезные проблемы с текстом, то дай тут поясниения и опиши как это исправить и что нужно изменить.",
                            "type": "string"
                        }
                    },
                    "required": ["acceptance", "annotation"]
                }
            },
         ]
    }
], ensure_ascii=False)


tool_config_any = json.dumps({
    "function_calling_config": {
        "mode": "ANY"   # AUTO - может запустить функцию или ответить текстом (по умолчанию), ANY или ONE - принудительно вызовет, в любом случае, NONE - игнор, только текстом
    }
})




